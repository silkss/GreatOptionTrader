<Window x:Class="GreatOptionTrader.Views.EditInstrumentGroupView"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:GreatOptionTrader.Views"
        mc:Ignorable="d"
        Title="Модифицирование группы." Height="450" Width="800">
    <DockPanel>
        <Menu DockPanel.Dock="Top">
            <MenuItem Header="Коннектор">
                <MenuItem Header="Подключить"/>
            </MenuItem>

            <MenuItem Header="Гуппа">
                <MenuItem Header="Запустить"/>
            </MenuItem>
        </Menu>
        
        <Grid DockPanel.Dock="Bottom">
            <Grid.RowDefinitions>
                <RowDefinition Height="42"/>
                <RowDefinition Height="42"/>
                <RowDefinition />
            </Grid.RowDefinitions>
        
            <Grid Grid.Row="0" Grid.Column="1">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition/>
                    <ColumnDefinition/>
                    <ColumnDefinition/>
                </Grid.ColumnDefinitions>

                <TextBox Grid.Column="0"
                         Style="{StaticResource BaseTextBoxStyle}"
                         Text="{Binding RequestedOptionName}"/>

                <TextBox Grid.Column="1"
                         Style="{StaticResource BaseTextBoxStyle}"
                         Text="{Binding RequestedOptionExchange}"/>

                <Button Content="Request" Grid.Column="2"
                        x:Name="btnRequest"
                        CommandParameter="{Binding}"
                        Style="{StaticResource BaseButtonStyle}"/>
            </Grid>

            <UniformGrid Grid.Row="1" Rows="1">
                <ComboBox Style="{StaticResource BaseComboBoxStyle}"
                          x:Name="cbAccounts"
                          SelectedItem="{Binding ElementName=lvInstruments, Path=SelectedItem.WantedAccount}"/>

                <ComboBox Style="{StaticResource BaseComboBoxStyle}"
                          ItemsSource="{Binding Source={StaticResource TradeDirectionToItemSource}}"
                          SelectedItem="{Binding ElementName=lvInstruments, Path=SelectedItem.WantedDirection}"/>

                <TextBox Style="{StaticResource BaseTextBoxStyle}"
                         Text="{Binding ElementName=lvInstruments, Path=SelectedItem.WantedVolume, Mode=TwoWay}"/>

                <TextBox Style="{StaticResource BaseTextBoxStyle}"
                         Text="{Binding ElementName=lvInstruments, Path=SelectedItem.WantedPrice, Mode=TwoWay}"/>

                <Button Content="SendOrder"
                        x:Name="btnSendOrder"
                        Style="{StaticResource BaseButtonStyle}"
                        CommandParameter="{Binding ElementName=lvInstruments, Path=SelectedItem}"/>

                <Button Content="CancelOrder"
                        x:Name="tbnCancelOrder"
                        CommandParameter="{Binding ElementName=lvInstruments, Path=SelectedItem}"
                        Style="{StaticResource BaseButtonStyle}"/>

            </UniformGrid>
           
            <DataGrid Grid.Row="2" IsReadOnly="True" AutoGenerateColumns="False"
                      x:Name="lvInstruments"
                      ItemsSource="{Binding Instruments}">
                <DataGrid.Columns>
                    <DataGridTextColumn Header="Bid" Binding="{Binding BidPrice}"
                                        ElementStyle="{StaticResource DataGridTextBlockStyle}"
                                        Width=".25*"/>
                    <DataGridTextColumn Header="Ask" Binding="{Binding AskPrice}" 
                                        ElementStyle="{StaticResource DataGridTextBlockStyle}"
                                        Width=".25*"/>
                    
                    <DataGridTextColumn Header="Инструмент" Binding="{Binding Instrument.Name}" 
                                        Width="1*"
                                        ElementStyle="{StaticResource DataGridTextBlockStyle}"/>
                    
                    <DataGridTextColumn Header="Объем" Binding="{Binding Position.CurrentVolume}"
                                        Width=".5*"
                                        ElementStyle="{StaticResource DataGridTextBlockStyle}"/>
                    
                    <DataGridTextColumn Header="Ср. цена" Binding="{Binding Position.AverageFilledPrice}"
                                        Width=".5*"
                                        ElementStyle="{StaticResource DataGridTextBlockStyle}"/>

                    <DataGridTextColumn Header="Открытый ПиУ" Binding="{Binding Position.CurrencyOpenPnL}"
                                        ElementStyle="{StaticResource DataGridTextBlockStyle}"
                                        Width=".5*"/>
                    

                    <DataGridTemplateColumn Header="Открытый ордер" Width="1.5*">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <UniformGrid Rows="1">
                                    <TextBlock Text="{Binding OpenOrder.Direction}" Style="{StaticResource BaseTextBlockStyle}"/>
                                    <TextBlock Text="{Binding OpenOrder.Quantity}" Style="{StaticResource BaseTextBlockStyle}"/>
                                    <TextBlock Text="{Binding OpenOrder.LimitPrice}" Style="{StaticResource BaseTextBlockStyle}"/>
                                </UniformGrid>
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                    </DataGridTemplateColumn>
                </DataGrid.Columns>
            </DataGrid>
        </Grid>
    </DockPanel>
</Window>
